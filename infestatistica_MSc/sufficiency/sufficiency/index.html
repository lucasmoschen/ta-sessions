<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">

    
    <title>Estat√≠stica suficiente - Teaching Assistance</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../../css/base.min.css" rel="stylesheet">
    <link href="../../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="../../..">Teaching Assistance</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Gradua√ß√£o <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../alglin/info/">√Ålgebra Linear</a>
</li>

                        
                            
<li >
    <a href="../../../analisenum/info/">An√°lise Num√©rica</a>
</li>

                        
                            
<li >
    <a href="../../../curvas/info/">Curvas</a>
</li>

                        
                            
<li >
    <a href="../../../edo/info/">Equa√ß√µes Diferenciais Ordin√°rias</a>
</li>

                        
                            
<li >
    <a href="../../../edp/info/">Equa√ß√µes Diferenciais Parciais</a>
</li>

                        
                            
<li >
    <a href="../../../infestatistica_BSc/info/">Infer√™ncia Estat√≠stica</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">P√≥s-gradua√ß√£o <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../functional_analysis/info/">An√°lise Funcional</a>
</li>

                        
                            
<li >
    <a href="../../../bayesian/info/">Estat√≠stica Bayesiana</a>
</li>

                        
                            
<li >
    <a href="../../../edp_PhD/info/">Equa√ß√µes Diferenciais Parciais e Aplica√ß√µes</a>
</li>

                        
                            
<li >
    <a href="../../info/">Infer√™ncia Estat√≠stica</a>
</li>

                        
                            
<li >
    <a href="../../../probability/info/">Probabilidade</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li>
                        <a href="https://lucasmoschen.github.io">P√°gina Inicial</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#estatistica-suficiente">Estat√≠stica suficiente</a></li>
            <li class="second-level"><a href="#fatorizacao-de-fisher-neyman">Fatoriza√ß√£o de Fisher-Neyman</a></li>
                
            <li class="second-level"><a href="#estatistica-suficiente-minima-e-completa">Estat√≠stica suficiente m√≠nima e completa</a></li>
                
            <li class="second-level"><a href="#ancilaridade">Ancilaridade</a></li>
                
            <li class="second-level"><a href="#computacional">Computacional</a></li>
                
                <li class="third-level"><a href="#amostrando">Amostrando!</a></li>
                <li class="third-level"><a href="#ancilaridade_1">Ancilaridade</a></li>
        <li class="first-level "><a href="#estamos-tomando-o-maximo-de-cada-linha-de-x-e-obtendo-100000-amostras-para-x">Estamos tomando o m√°ximo de cada linha de X e obtendo 100000 amostras para X.</a></li>
            <li class="second-level"><a href="#estimadores-aleatorios-e-convexidade">Estimadores aleat√≥rios e convexidade</a></li>
                
                <li class="third-level"><a href="#teorema-de-rao-blackwell">Teorema de Rao-Blackwell</a></li>
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="estatistica-suficiente">Estat√≠stica suficiente</h1>
<p>Um estat√≠stico usa a informa√ß√£o de uma amostra <script type="math/tex">X_1, \dots, X_n</script> para fazer infer√™ncia sobre uma quantidade de interesse <script type="math/tex">\theta</script>.
De acordo com Fisher, em "On the Mathematical Foundations of Theoretical Statistics", "o objeto dos m√©todos estat√≠sticos √© a redu√ß√£o dos dados".
Como a quantidade de dados √© incapaz de ser compreendida diretamente pelo c√©rebro, ela √© reduzida por poucas quantidades que representam o todo, pelo menos a informa√ß√£o relevante para o problema. 
Nesse sentido, uma estat√≠stica √© uma forma de representar esses dados, em geral diminuir sua dimens√£o (os pr√≥prios dados formam uma estat√≠stica, ent√£o isso n√£o √© uma condi√ß√£o necess√°ria).
De forma precisa, a defini√ß√£o de <strong>estat√≠stica</strong> √©:</p>
<blockquote>
<p>Seja <script type="math/tex">(\mathcal{T}, \mathcal{C})</script> um espa√ßo mensur√°vel em que <script type="math/tex">\mathcal{C}</script> contenha todos os conjuntos unit√°rios formados pelo elementos de <script type="math/tex">\mathcal{T}</script>. Se <script type="math/tex">T : \mathcal{X} \to \mathcal{T}</script> √© mensur√°vel, ent√£o <script type="math/tex">T</script> √© uma estat√≠stica.</p>
</blockquote>
<p>Com isso, podemos definir uma <strong>estat√≠stica suficiente</strong> no sentido cl√°ssico (lembrando que temos uma contrapartida bayesiana baseada na posteriori).</p>
<blockquote>
<p>Seja <script type="math/tex">T: \mathcal{X} \to \mathcal{T}</script> uma estat√≠stica e <script type="math/tex">\mathcal{P}</script> uma fam√≠lia de distribui√ß√µes parametrizada por <script type="math/tex">\theta</script> e definida em <script type="math/tex">(\mathcal{X}, \mathcal{B})</script> (espa√ßo amostral com <script type="math/tex">\sigma</script>-√°lgebra <script type="math/tex">\mathcal{B}</script>). Suponha que existem <script type="math/tex">P_{\theta}(\cdot|T)</script> e uma fun√ß√£o <script type="math/tex">r : \mathcal{B} \times \mathcal{T} \to [0,1]</script> tal que <script type="math/tex">r(\cdot, t)</script> √© uma medida de probabilidade em <script type="math/tex">(\mathcal{X}, \mathcal{B})</script> para todo <script type="math/tex">t \in \mathcal{T}</script>, <script type="math/tex">r(A, \cdot)</script> √© mensur√°vel para todo <script type="math/tex">A \in \mathcal{B}</script> e, para todo <script type="math/tex">\theta \in \Theta</script> e <script type="math/tex">B \in \mathcal{B}</script>,
<script type="math/tex; mode=display">
P_{\theta}(B|T=t) = r(B,t)
</script>
quase certamente. Ent√£o dizemos que <script type="math/tex">T</script> √© <strong>estat√≠stica suficiente</strong> para <script type="math/tex">\theta</script>.</p>
</blockquote>
<p>Apesar dessa defini√ß√£o ser bastante complexa, a ideia √© que a distribui√ß√£o condicional de <script type="math/tex">X</script> dado <script type="math/tex">T=t</script> n√£o depende de <script type="math/tex">\theta</script>, isto √©, a informa√ß√£o trazida por <script type="math/tex">T=t</script> sobre <script type="math/tex">\theta</script> compreende toda a informa√ß√£o dispon√≠vel de <script type="math/tex">X</script>.
Ap√≥s observar <script type="math/tex">T(x) = t</script>, podemos amostrar de <script type="math/tex">r(\cdot, t)</script> e teremos dados falsos que imitam os iniciais, pois a distribui√ß√£o ser√° a mesma.
Assim, se considerarmos dois experimentadores, um tendo a amostra inteira, e o outro tendo apenas uma estat√≠stica suficiente, ambos ter√£o a mesma quantidade de informa√ß√£o sobre o par√¢metro de interesse <script type="math/tex">\theta</script>.</p>
<p>Note que, pela lei da esperan√ßa total,
<script type="math/tex; mode=display">
P_{\theta}(X \in B) = \mathbb{E}_{\theta}[P_{\theta}(X \in B|T)] = \mathbb{E}_{\theta}[r(B, T)].
</script>
Se tomarmos <script type="math/tex">Y \sim r(\cdot, t)</script> quando <script type="math/tex">T=t</script>, teremos 
<script type="math/tex; mode=display">
P_{\theta}(Y \in B) = \mathbb{E}_{\theta}[P_{\theta}(Y \in B|T)] = \mathbb{E}_{\theta}[r(B, T)].
</script>
</p>
<p><strong>Proposi√ß√£o:</strong> A estat√≠stica de ordem <script type="math/tex">(X_{(1)}, \dots, X_{(n)})</script> √© estat√≠stica suficiente.</p>
<h2 id="fatorizacao-de-fisher-neyman">Fatoriza√ß√£o de Fisher-Neyman</h2>
<p>Seja <script type="math/tex">f(\boldsymbol{x}|\theta)</script> a densidade de uma distribui√ß√£o de <script type="math/tex">\boldsymbol{X} = (X_1, \dots, X_n)</script> (com respeito a uma medida <script type="math/tex">\nu</script>
<script type="math/tex">\sigma</script>-finita, como a medida de Lebesgue em <script type="math/tex">\mathbb{R}^n</script>). Ent√£o <script type="math/tex">T(\boldsymbol{X})</script> √© estat√≠stica suficiente para <script type="math/tex">\theta</script> se, e somente se, existem fun√ß√µes <script type="math/tex">m_1</script> e <script type="math/tex">m_2</script> tal que 
<script type="math/tex; mode=display">
f(\boldsymbol{x}|\theta) = m_1(\boldsymbol{x})m_2(T(\boldsymbol{x}) , \theta), \forall \theta \in \Theta.
</script>
</p>
<p>O lema 2.24 demonstrado no livro de Schervish determina que sob as hip√≥teses do teorema de Fisher-Neyman e assumindo que <script type="math/tex">T</script> √© suficiente, obtemos que existe uma medida em <script type="math/tex">(\mathcal{T}, \mathcal{C})</script> que domina a distribui√ß√£o de probabilidade de <script type="math/tex">T</script> e define a densidade de <script type="math/tex">T=t</script> sob o par√¢metro <script type="math/tex">\theta</script> como <script type="math/tex">m_2(t,\theta)</script>.</p>
<h2 id="estatistica-suficiente-minima-e-completa">Estat√≠stica suficiente m√≠nima e completa</h2>
<p>A estat√≠stica de ordem √© uma estat√≠stica que pouco reduz a informa√ß√£o do dado. 
De fato, s√≥ retira a quest√£o da ordena√ß√£o. 
Todavia, algumas vezes uma estat√≠stica mais simples tamb√©m √© suficiente e, por isso, faz sentido definir quando ela √© m√≠nima.</p>
<blockquote>
<p>Uma estat√≠stica suficiente <script type="math/tex">T</script> √© dita <strong>suficiente m√≠nima</strong> se para toda estat√≠stica suficiente <script type="math/tex">U</script>, existe uma fun√ß√£o mensur√°vel <script type="math/tex">g</script> tal que <script type="math/tex">T = g(U)</script> para todo <script type="math/tex">\theta</script>.</p>
</blockquote>
<p><strong>Teorema (Lehmann-Scheff√©):</strong> Seja <script type="math/tex">f(x|\theta)</script> a densidade e <script type="math/tex">T</script> uma fun√ß√£o mensur√°vel tal que <script type="math/tex">T(x) = T(y) \iff y \in D(x)</script>, com
<script type="math/tex; mode=display">
D(x) = \{y \in \mathcal{X} : f(y|\theta) = f(x|\theta)h(x,y), \forall \theta \text{ e alguma fun√ß√£o } h(x,y) \},
</script>
ent√£o <script type="math/tex">T(X)</script> √© estat√≠stica suficiente m√≠nima.</p>
<hr />
<p><code>üìù</code> <strong>Exemplo</strong>
}
Seja <script type="math/tex">X_1, \dots, X_n \overset{iid}{\sim} \operatorname{Bernoulli}(\theta)</script>. Temos que 
<script type="math/tex; mode=display">
f(x_1,\dots,x_n|\theta) = \theta^{S_x}(1-\theta)^{n-S_x},
</script>
em que <script type="math/tex">S_x = \sum_{i=1}^n x_i</script>. 
Assim
<script type="math/tex; mode=display">
\frac{f(x_1,\dots,x_n|\theta)}{f(y_1,\dots,y_n|\theta)} = \left(\frac{\theta}{1-\theta}\right)^{S_x-S_y},
</script>
que independe de <script type="math/tex">\theta</script> se, e somente se, <script type="math/tex">S_x = S_y</script>. 
Isso mostra que <script type="math/tex">T(x) = S_x</script> √© estat√≠stica suficiente m√≠nima.</p>
<hr />
<hr />
<p><code>üìù</code> <strong>Exemplo - Fam√≠lia Exponencial</strong></p>
<p>Considere uma distribui√ß√£o com densidade 
<script type="math/tex; mode=display">
p_{\theta}(x) = \exp\{\eta(\theta)\cdot T(x) - B(\theta)\}h(x)
</script>
com respeito a medida de Lebesgue. 
Pelo Teorema da Fatoriza√ß√£o <script type="math/tex">T(x)</script> √© estat√≠stica suficiente.
Assim
<script type="math/tex; mode=display">
\log\left(\frac{p_{\theta}(y)}{p_{\theta}(x)}\right) = \eta(\theta)\cdot (T(y) - T(x)) + \log(h(y)) - \log(h(x)).
</script>
Logo <script type="math/tex">T</script> √© estat√≠stica suficiente m√≠nima se, e somente se, o complemento ortogonal de <script type="math/tex">\eta(\theta)</script> possui apenas o <script type="math/tex">0</script>.</p>
<hr />
<blockquote>
<p>Uma estat√≠stica <script type="math/tex">T</script> √© dita <strong>completa</strong> se para toda fun√ß√£o <script type="math/tex">g</script> mensur√°vel e <script type="math/tex">\theta \in \Theta</script>, <script type="math/tex">\mathbb{E}_{\theta}[g(T)] = 0</script> implique <script type="math/tex">g(T) = 0</script>. Ela ser√° <strong>completa limitada</strong> se adicionamos a condi√ß√£o de que <script type="math/tex">g</script> √© limitada.</p>
</blockquote>
<p><strong>Teorema de Bahadur:</strong> Se <script type="math/tex">U</script> √© uma estat√≠stica suficiente completa limitada e de dimens√£o finita, ent√£o ela √© suficiente m√≠nima.</p>
<p>Ideias da demonstra√ß√£o:</p>
<ul>
<li>Tome uma outra estat√≠stica <script type="math/tex">T</script> e defina <script type="math/tex">V_i(U) = (1 + \exp\{U_i\})^{-1}</script> para cada componente de <script type="math/tex">U</script>. Note que <script type="math/tex">V</script> √© limitada.</li>
<li>Defina <script type="math/tex">H_i(t)</script> como o valor esperado de <script type="math/tex">V_i</script> dado que <script type="math/tex">T=t</script> e <script type="math/tex">L_i(u)</script> como o valor esperado de  <script type="math/tex">H_i(T)</script> quando <script type="math/tex">U=u</script>, que n√£o dependem de <script type="math/tex">\theta</script>, pois as estat√≠sticas s√£o suficientes.</li>
<li>Veja que <script type="math/tex">\mathbb{E}_{\theta}[V_i(U) - L_i(U)] = 0</script>, o que implica que <script type="math/tex">\mathbb{P}(V_i = L_i) = 1</script> pois <script type="math/tex">U</script> √© completa.</li>
<li>Conclua usando a Lei da Vari√¢ncia Total que <script type="math/tex">U_i = V_i^{-1}(H_i(T))</script>.</li>
</ul>
<p>Note que se <script type="math/tex">U</script> √© completa, ent√£o <script type="math/tex">U</script> √© completa limitada, o que nos d√° um resultado mais claro: Uma estat√≠stica suficiente e completa √© suficiente m√≠nima.</p>
<h2 id="ancilaridade">Ancilaridade</h2>
<p>Na outra ponta, temos estat√≠sticas que s√£o independentes do par√¢metro.</p>
<blockquote>
<p>Uma estat√≠stica <script type="math/tex">U</script> √© dita anciliar se a sua distribui√ß√£o independe de <script type="math/tex">\theta</script>.</p>
</blockquote>
<hr />
<p><code>üìù</code> <strong>Exemplo - Caso normal</strong></p>
<p>Sejam <script type="math/tex">X_1, X_2 \overset{iid}{\sim} \operatorname{Normal}(\mu, 1)</script> e defina <script type="math/tex">U = X_2 - X_1</script>. Soma de normais independentes faz com que 
<script type="math/tex">U \sim \operatorname{Normal}(0, 2)</script> e <script type="math/tex">U</script> √© anciliar.</p>
<hr />
<p>Se <script type="math/tex">T=(T_1, T_2)</script> √© estat√≠stica suficiente m√≠nima e <script type="math/tex">T_2</script> √© anciliar, dizemos que <script type="math/tex">T_1</script> √© <strong>suficiente condicionalmente</strong> dado <script type="math/tex">T_2</script>.</p>
<p>Quando uma estat√≠stica √© anciliar, n√£o significa que ela n√£o tem import√¢ncia e, portanto, deveria ser ignorada. 
Significa que se ela fosse a √∫nica observa√ß√£o poss√≠vel, n√£o mudar√≠amos a informa√ß√£o sobre <script type="math/tex">\theta</script>. 
Podemos, todavia, alterar a informa√ß√£o sobre outras quantidades, todavia.</p>
<p>Uma estat√≠stica ancilar <script type="math/tex">U</script> √© <strong>maximal</strong> se toda outra estat√≠stica ancilar √© fun√ß√£o de <script type="math/tex">U</script>.</p>
<p><strong>Teorema de Basu:</strong> se <script type="math/tex">T</script> √© uma estat√≠stica suficiente completa limitada e <script type="math/tex">U</script> √© anciliar, ent√£o <script type="math/tex">U</script> e <script type="math/tex">T</script> s√£o independentes sob <script type="math/tex">P_{\theta}</script> para qualquer <script type="math/tex">\theta</script>.</p>
<h2 id="computacional">Computacional</h2>
<p>Nesse notebook, que est√° dispon√≠vel <a href="https://nbviewer.org/github/lucasmoschen/ta-sessions/blob/master/Statistical_Inference_MSc/Notebooks/Sufficient_Statistics.ipynb">neste link</a>, faremos alguns poucos experimentos para ilustrar fatos verificados no cap√≠tulo de Estat√≠stica Suficiente.</p>
<p><code>python
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
from tqdm import tqdm</code></p>
<h3 id="amostrando">Amostrando!</h3>
<p>Seja <script type="math/tex">X_1, \dots, X_n</script> uma amostra aleat√≥ria de uma distribui√ß√£o <script type="math/tex">P_{\theta}</script>. 
Seja <script type="math/tex">T(X)</script> uma estat√≠stica suficiente. 
Sabemos que <script type="math/tex">\mathbb{P}(X_1, \dots, X_n | T(X) = t)</script> independe de <script type="math/tex">\theta</script>.
Suponha ent√£o que temos dois experimentadores. 
O primeiro captura todas as amostras e passa para o segundo experimentador apenas o valor de <script type="math/tex">T(X)</script> para economizar!
Vamos verificar que o segundo experimentador consegue, agora, obter amostras fake da amostra original.</p>
<p>Vamos come√ßar com um exemplo simples: <script type="math/tex">X_1, \dots, X_n \sim \operatorname{Normal}(\mu, 1)</script>. Uma estat√≠stica suficiente (m√≠nima, inclusive) nesse caso √© <script type="math/tex">\bar{X} = n^{-1}(X_1 + \dots + X_n)</script>.</p>
<p>Sabemos que <script type="math/tex">\bar{X} \sim \operatorname{Normal}(\mu, n^{-1})</script>. Assim, 
<script type="math/tex; mode=display">
f(X_1, \dots, X_n | \bar{X} = t) = \frac{(2\pi)^{-n/2}\exp\{-1/2 \sum_{i=1}^n(x_i-\mu)^2\}}{(2\pi n^{-1})^{-1/2}\exp\{-n/2(t-\mu)^2\}} \propto \exp\left\{-\frac{1}{2}(S_x^2 - 2\mu n t + n\mu^2 - nt^2 + 2\mu n t - n\mu^2).\right\} = \exp\left\{-\frac{1}{2}\sum_{i=1}^n (x_i^2 - t^2)\right\},
</script>
em que <script type="math/tex">S_x^2 = \sum_{i=1}^n x_i^2</script> e <script type="math/tex">X_n = nt - \sum_{i=1}^{n-1} X_i</script>.</p>
<p>Note que podemos escrever 
<script type="math/tex; mode=display">
f(X_1, \dots, X_{n-1} | \bar{X} = t) \propto \exp\left\{nt^2/2\right\}\exp\left\{-\frac{1}{2}\left[\sum_{i=1}^{n-1} x_i^2 + \left(nt - \sum_{i=1}^{n-1} x_i\right)^2 \right]\right\} = \exp\left\{nt^2/2\right\}\exp\left\{-\frac{1}{2}\left[\sum_{i=1}^{n-1} x_i^2 + n^2t^2 - 2nt\sum_{i=1}^{n-1} x_i + \left(\sum_{i=1}^{n-1} x_i\right)^2\right]\right\}
</script>
</p>
<p>Assim, 
<script type="math/tex; mode=display">
\begin{split}
f(X_1, \dots, X_{n-1} | \bar{X} = t) &\propto \exp\left\{nt^2/2\right\}\exp\left\{-\frac{1}{2}\left[\sum_{i=1}^{n-1} (x_i^2 - 2nt x_i + nt^2) +nt^2 + \left(\sum_{i=1}^{n-1} x_i\right)^2\right]\right\} \\
&= \exp\left\{-\frac{1}{2}\left[\sum_{i=1}^{n-1} (x_i^2 - 2t x_i + t^2) - 2(n-1)t\sum_{i=1}^{n-1} x_i + (n-1)^2t^2 + \left(\sum_{i=1}^{n-1} x_i\right)^2\right]\right\} \\
&= \exp\left\{-\frac{1}{2}\left[\sum_{i=1}^{n-1} (x_i - t)^2 + \left(\sum_{i=1}^{n-1} (x_i - t)\right)^2 \right]\right\} \\
&= \exp\left\{-\frac{1}{2}\left[\sum_{i=1}^{n-1} (x_i - t)^2 + \sum_{j=1}^{n-1} \sum_{i=1}^{n-1} (x_j-t)(x_i - t) \right]\right\}
\end{split}
</script>
</p>
<p>Com isso, observamos que <script type="math/tex">X_1, \dots, X_n | \bar{X} = t</script> tem distribui√ß√£o Normal Multivariada com <script type="math/tex">\mathbb{E}[X_i] = t</script> para <script type="math/tex">i=1,\dots,n-1</script>
e matriz de covari√¢ncia (dada pela inversa) 
<script type="math/tex; mode=display">
\Sigma^{-1} = I_{n-1} + \begin{bmatrix}
1 & \cdots & 1 \\
\vdots & \ddots & \vdots \\
1 & \cdots & 1
\end{bmatrix} := I + A
</script>
</p>
<p>Veja que <script type="math/tex">\Sigma = I - A/n</script> (mostre!). </p>
<p>Assim, <script type="math/tex">X_1, \dots, X_{n-1} | \bar{X} = t \sim \operatorname{Normal}((t,\dots,t), I - A/n)</script>.</p>
<p><code>python
mu = 2
n = 10
Sigma = np.eye(n-1) - np.ones((n-1,n-1))/n</code></p>
<p>Fa√ßamos um exemplo em que <script type="math/tex">\mu = 2</script> verdadeiro (e desconhecido para os dois estat√≠sticos). Vamos fazer o seguinte experimento <script type="math/tex">M</script> vezes, com <script type="math/tex">M = 100000</script>. Para o primeiro estat√≠stico, oferecemos <script type="math/tex">n</script> amostras. Para o segundo estat√≠stico, s√≥ oferecemos a m√©dia dessas amostras e ele vai utilizar as contas acima para gerar outras <script type="math/tex">n</script> amostras, isto, ele gerar√° amostras novas a partir de <script type="math/tex">X_1, \dots, X_{n-1} | \bar{X} = t \sim \operatorname{Normal}((t,\dots,t), I - A/n)</script>, pois ele conhecer√° <script type="math/tex">\bar{X}</script>. </p>
<p>Como faremos esses experimentos diversas vezes, vamos obter <script type="math/tex">M</script> amostras de <script type="math/tex">X_1</script> para o estat√≠stico 1, e o estat√≠stico 2 vai produzir outras <script type="math/tex">M</script> a partir da distribui√ß√£o calculada. Provamos que a distribui√ß√£o delas ser√° a mesma. Vamos verificar graficamente atrav√©s do histograma.</p>
<p>```python
mu = 2
n = 10
M = 100000</p>
<p>estatistico1 = np.zeros((M, n))
estatistico2 = np.zeros_like(estatistico1)</p>
<p>for k in tqdm(range(M)):
    x = np.random.normal(loc=mu, scale=1, size=n)
    t = x.mean()</p>
<pre><code>x_fake = np.random.multivariate_normal(mean=t*np.ones(n-1), cov=np.eye(n-1) - np.ones((n-1, n-1))/n)
x_n = n * t - x_fake.sum()
x_fake = np.hstack([x_fake, x_n])

estatistico1[k] = x
estatistico2[k] = x_fake
</code></pre>
<p>```</p>
<pre><code>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100000/100000 [00:19&lt;00:00, 5034.15it/s]
</code></pre>
<p>Veja que de fato os histogramas s√£o muito similares, como esper√°vamos! Assim, apenas tendo o valor da m√©dia, o estat√≠stico 2 foi capaz de produzir novas amostras a partir da mesma distribui√ß√£o do estat√≠stico 1!</p>
<p><code>python
plt.hist(estatistico1[:,0], bins=50, label='Estat√≠stico 1')
plt.hist(estatistico2[:,0], alpha=0.5, bins=50, label='Estat√≠stico 2')
plt.title('Comparando a distribui√ß√£o do dado contra o dado falso')
plt.legend()
plt.show()</code> </p>
<p><img alt="png" src="../output_9_0.png" /></p>
<h3 id="ancilaridade_1">Ancilaridade</h3>
<p>Uma estat√≠stica anciliar n√£o depende do par√¢metro, ent√£o n√£o pode atualizar a informa√ß√£o sobre ele. 
Ser√° que significa que ela pode ser ignorada? 
Vamos verificar isso com um exemplo num√©rico. Seja <script type="math/tex">X_1, \dots, X_n \overset{iid}{\sim} \operatorname{Unif}[\theta-1/2, \theta+1/2]</script>. Assim 
<script type="math/tex; mode=display">
f(x_1, \dots, x_n | \theta) = \prod_{i=1}^n 1\{\theta -1/2 < x_i < \theta+1/2\} = 1\{\theta - 1/2 < \min\{x_i\}\}1\{\theta + 1/2 > \max\{x_i\}\}
</script>
Portanto <script type="math/tex">T(X) = (\min(X_i), \max(X_i))</script> √© estat√≠stica suficiente m√≠nima.
Seja <script type="math/tex">U(X) = \max(X_i) - \min(X_i)</script>.
Vamos verificar que <script type="math/tex">U</script> √© estat√≠stica anciliar </p>
<p>Defina <script type="math/tex">Y_i = X_i - \theta + 1/2 \sim \operatorname{Uniform}(0,1)</script>. Assim, 
<script type="math/tex; mode=display">
U = \max(X_i) - \min(X_i) = \max(X_i-\theta+1/2) - \min(X_i-\theta+1/2) = \max(Y_i) - \min(Y_i).
</script>
Como a distribui√ß√£o de <script type="math/tex">Y</script> independe de <script type="math/tex">\theta</script>, temos que a distribui√ß√£o de <script type="math/tex">U</script> tamb√©m independe, o que mostra que <script type="math/tex">U</script> √© estat√≠stica anciliar.</p>
<p>Vamos visualizar a distribui√ß√£o de <script type="math/tex">U</script> de duas formas: partindo de <script type="math/tex">X</script> e partido de <script type="math/tex">Y</script>.</p>
<p>```python
theta = 5
n = 10</p>
<p>X = np.random.uniform(theta-1/2, theta+1/2, size=(100000, n))
Y = np.random.uniform(size=(100000, n))</p>
<h1 id="estamos-tomando-o-maximo-de-cada-linha-de-x-e-obtendo-100000-amostras-para-x">Estamos tomando o m√°ximo de cada linha de X e obtendo 100000 amostras para X.</h1>
<p>U1 = X.max(axis=1) - X.min(axis=1)
U2 = Y.max(axis=1) - Y.min(axis=1)
```</p>
<p>Note que de fato as distribui√ß√µes s√£o muito similares.</p>
<p><code>python
plt.hist(U1,  bins=50, label='U = max(X_i) - min(X_i)')
plt.hist(U2, alpha=0.5, bins=50, label='U = max(Y_i) - min(Y_i)')
plt.title('Comparando a distribui√ß√£o de U')
plt.legend()
plt.show()</code></p>
<p><img alt="png" src="../output_13_0.png" /></p>
<p>Se observamos que <script type="math/tex">U(X) = u</script>, podemos calcular que <script type="math/tex">\max(x_i) | U = u \sim \operatorname{Unif}(\theta-1/2+u, \theta+1/2)</script>. 
Assim, a distribui√ß√£o de uma estat√≠stica muda com outra anciliar.</p>
<h2 id="estimadores-aleatorios-e-convexidade">Estimadores aleat√≥rios e convexidade</h2>
<p>O seguinte resultado √© a Desigualdade de Jensen:</p>
<blockquote>
<p>Seja <script type="math/tex">I</script> um intervalo aberto tal que <script type="math/tex">\mathbb{P}(X \in I) = 1</script> e <script type="math/tex">f</script> uma <a href="https://en.wikipedia.org/wiki/Convex_function#Definition">fun√ß√£o convexa</a>. 
Se <script type="math/tex">X</script> √© integr√°vel, ent√£o 
<script type="math/tex; mode=display">
f\left(\mathbb{E}[X]\right) \le \mathbb{E}[f(X)].
</script>
Se <script type="math/tex">f</script> √© estritamente convexa, a desigualdade √© estrita a menos que <script type="math/tex">X</script> seja constante com probabilidade 1.</p>
</blockquote>
<p>Um <strong>estimador randomizado</strong> √© um estimador que pode ser constru√≠do a partir de uma estat√≠stica suficiente <script type="math/tex">T</script> com a gera√ß√£o auxiliar de n√∫meros aleat√≥rios, isto √©, √© uma fun√ß√£o que mapeia <script type="math/tex">x \in \mathcal{X}</script> a uma vari√°vel aleat√≥ria <script type="math/tex">Y(x)</script> com distribui√ß√£o <script type="math/tex">P_x</script>.</p>
<p><strong>Teorema:</strong> Seja <script type="math/tex">X \sim P_{\theta} \in \mathcal{P}</script> e <script type="math/tex">T = T(X)</script> uma estat√≠stica suficiente.
Ent√£o, para qualquer estimador <script type="math/tex">\phi(X)</script> para <script type="math/tex">g(\theta)</script>, existe um estimador randomizado baseado em <script type="math/tex">T</script> que tem a mesma fun√ß√£o de risco de <script type="math/tex">\phi(X)</script>.</p>
<hr />
<p>Ideia da prova: a distribui√ß√£o de <script type="math/tex">X</script> condicionada em <script type="math/tex">T</script> n√£o depende de <script type="math/tex">\theta</script>, pois <script type="math/tex">T</script> √© suficiente.
Seja <script type="math/tex">r(\cdot, T=t)</script> essa distribui√ß√£o.
Assim, uma vari√°vel aleat√≥ria <script type="math/tex">Y</script> com essa distribui√ß√£o tem a mesma distribui√ß√£o marginal de <script type="math/tex">X</script>, como verificamos <a href="https://lucasmoschen.github.io/ta-sessions/infestatistica_MSc/sufficiency/sufficiency/">aqui</a>. 
Em particular <script type="math/tex">\phi(Y)</script> tem a mesma distribui√ß√£o de <script type="math/tex">\phi(X)</script>.</p>
<hr />
<h3 id="teorema-de-rao-blackwell">Teorema de Rao-Blackwell</h3>
<p>Sejam <script type="math/tex">T</script> uma estat√≠stica suficiente para <script type="math/tex">\theta</script> de uma fam√≠lia de distribui√ß√µes <script type="math/tex">P_{\theta}</script> e <script type="math/tex">\delta</script> um estimador de <script type="math/tex">g(\theta)</script>.
Defina <script type="math/tex">\eta(T) = \mathbb{E}[\delta(X)|T]</script>.
Se <script type="math/tex">R(\theta, \delta) < +\infty</script>, em que <script type="math/tex">R</script> √© a <a href="https://lucasmoschen.github.io/ta-sessions/infestatistica_MSc/risk_function/">fun√ß√£o de risco</a> para uma perda <script type="math/tex">L</script>, e <script type="math/tex">L(\theta, \cdot)</script> √© convexa, ent√£o
<script type="math/tex; mode=display">
R(\theta, \eta) \le R(\theta, \delta).
</script>
Al√©m do mais, se a perda √© estritamente convexa, a desigualdade √© estrita a menos que <script type="math/tex">\delta(X) = \eta(T)</script> com probabilidade 1.
Esse resultado √© uma consequ√™ncia direta da Desigualdade de Jensen.</p>
<p>Esse resultado mostra que para perdas convexas, sob a √≥tica do risco apenas, os √∫nicos estimadores interessantes s√£o aqueles que s√£o fun√ß√£o de <script type="math/tex">T</script> e n√£o de <script type="math/tex">X</script> (visto que estamos integrando em <script type="math/tex">X</script>).
Al√©m do mais, qualquer estimador randomizado √© pior do que o n√£o randomizado tomando a esperan√ßa dele condicionada em um estat√≠stica suficiente. </p>
<p><em>Observa√ß√£o: <script type="math/tex">\eta(T)</script> √© uma estat√≠stica, pois n√£o depende de <script type="math/tex">\theta</script>, dado que <script type="math/tex">T</script> √© suficiente.</em></p></div>
        
        
    </div>

    
      <footer class="col-md-12 text-center">
          
          
            <hr>
            <p>
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
            </p>
          

          
          
      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = "../../.."</script>
    
    <script src="../../../js/base.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
